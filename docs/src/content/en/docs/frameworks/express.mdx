---
title: "Getting started with Mastra and Express | Mastra Guides"
description: Guide on integrating Mastra with Express.
---

import { Callout, Steps, Tabs, FileTree } from "nextra/components";

# Integrate Mastra in your Express project

There are several reasons to use Mastra with an Express backend:

- Build a flexible API to serve AI-powered features
- Maintain full control over your server logic and routing
- Scale your backend independently from your frontend

This guide will help you set up and integrate Mastra agents in your Express app.

## Install Mastra

There are several ways to get started with Mastra. Refer to the [Create a New Project](/docs/getting-started/installation#create-a-new-project) section in the Getting Started guide, where you can use the CLI in the following modes:

- [Interactive](/docs/getting-started/installation#interactive)
- [Non-Interactive](/docs/getting-started/installation#non-interactive)

Alternatively, if you prefer more control, follow the [Manual Installation](/docs/getting-started/installation#manual-installation) instructions.

This guide builds upon the default [Weather Tool](/docs/getting-started/installation#create-a-tool) and [Weather Agent](/docs/getting-started/installation#create-an-agent) setups.


## Installing Express

Once you have a new Mastra project created, you can now install Express.

### Install dependencies

```bash copy
npm install express
```

### Create API

The following steps will create an `api` directory and set up an Express server that accepts a `city` query parameter, which is used by the Weather Agent. Upon a successful request, the server returns the agent's response.

### Create Directory

Create a directory for the Express server:

```bash copy
mkdir api
```

### Create Server

Create an entry point for the Express server:

```bash copy
touch api/index.ts
```

Add the following code:

```typescript filename="/api/index.ts" showLineNumber copy
import express from "express";
import { mastraClient } from "../lib/mastra";

const app = express();
const port = 3000;

app.get("/api/weather", async (req, res) => {
  const { city } = req.query;

  if (!city) {
    return res.status(400).send("Missing 'city' query parameter");
  }

  const agent = mastraClient.getAgent("weatherAgent");

  try {
    const result = await agent.generate({
      messages: [
        { role: "user", content: `What's the weather like in ${city}?` }
      ]
    });
    res.send(result.text);
  } catch (error) {
    console.error("Agent error:", error);
    res.status(500).send("Something went wrong.");
  }
});

app.listen(port, () => {
  console.log(`Example app listening on port ${port}`);
});
```

## Install the Mastra Client

The following steps will install the MastraClient instance that can be used by the Express server:

<Tabs items={["npm", "yarn", "pnpm", "bun"]}>
  <Tabs.Tab>
    ```bash copy
    npm install @mastra/client-js@latest
    ```
  </Tabs.Tab>
  <Tabs.Tab>
    ```bash copy
    yarn add @mastra/client-js@latest
    ```
  </Tabs.Tab>
  <Tabs.Tab>
    ```bash copy
    pnpm add @mastra/client-js@latest
    ```
  </Tabs.Tab>
  <Tabs.Tab>
    ```bash copy
    bun add @mastra/client-js@latest
    ```
  </Tabs.Tab>
</Tabs>

You may also need to install `dotenv` to load environment variables locally during development:

```bash copy
npm install dotenv --save-dev
```

Create a directory for the client:

```bash copy
mkdir lib
```
Create the client:

```bash copy
touch lib/mastra.ts
```

Add the following code:

```typescript filename="/lib/mastra.ts" showLineNumbers copy
import "dotenv/config";

import { MastraClient } from "@mastra/client-js";

export const mastraClient = new MastraClient({
  baseUrl: process.env.PUBLIC_MASTRA_API_URL || "http://localhost:4111"
});
```

## Project Structure

Your project structure should now look similar to this:

<FileTree>
  <FileTree.Folder name="api" defaultOpen>
    <FileTree.File name="index.ts" />
  </FileTree.Folder>
  <FileTree.Folder name="lib" defaultOpen>
    <FileTree.File name="mastra.ts" />
  </FileTree.Folder>
  <FileTree.Folder name="src" defaultOpen>
    <FileTree.Folder name="mastra" defaultOpen>
      <FileTree.Folder name="agents" defaultOpen>
        <FileTree.File name="agent-name.ts" />
      </FileTree.Folder>
      <FileTree.Folder name="tools" defaultOpen>
        <FileTree.File name="tool-name.ts" />
      </FileTree.Folder>
      <FileTree.File name="index.ts" />
    </FileTree.Folder>
  </FileTree.Folder>
  <FileTree.File name=".env" />
  <FileTree.File name="package.json" />
  <FileTree.File name="tsconfig.json" />
</FileTree>

## Developing

There are two ways to test your Express server. Both will require the Mastra dev server to be running:

### Start the Mastra Dev Server

```bash copy
npm run dev
```

### Start the Express Server

To start the Express server in watch mode, run the following:

```bash
npx tsx --watch api/index.ts --watch-dir api
```

You can now visit the following URL in your browser:

- [http://localhost:3000/api/weather?city=London](http://localhost:3000/api/weather?city=London)

Or run the below command from the terminal:

```bash copy
curl "http://localhost:3000/api/weather?city=London"
```

In both cases, you should see output similar to the following:

```plaintext
Agent response: The current weather in London is as follows:

- **Temperature:** 12.9°C (Feels like 9.7°C)
- **Humidity:** 63%
- **Wind Speed:** 14.7 km/h
- **Wind Gusts:** 32.4 km/h
- **Conditions:** Overcast

Let me know if you need more information!
```


## Next Steps

- [Using Express.js with Vercel](https://vercel.com/guides/using-express-with-vercel)


